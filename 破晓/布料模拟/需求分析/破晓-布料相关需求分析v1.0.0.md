# 破晓-布料相关需求分析

### 需求背景
目前游戏所有设计的角色(男性，女性，老者)都是统一使用一套骨架共用一套动画，最多同屏18个玩家
![avater](/%E5%B8%83%E6%96%99%E6%A8%A1%E6%8B%9F/%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/%E9%80%9A%E7%94%A8%E9%AA%A8%E6%9E%B6.jpg)
### 需求描述
因为通用动画上并不考虑布料部分动画，所以希望能在模型布料部件上，会有一些布料动态效果，具体细节如下
- 布料效果需在角色移动，攻击，跳跃等交互行为时产生自然的布料物理摆动
- 布料效果应用场景位置
**手部袖子，裙子(尾部)，披风**
![avater](/%E5%B8%83%E6%96%99%E6%A8%A1%E6%8B%9F/%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/%E5%B8%83%E6%96%99%E9%9C%80%E6%B1%823.jpg)
- 裙子种类，短裙，中裙，长裙
![avater](/%E5%B8%83%E6%96%99%E6%A8%A1%E6%8B%9F/%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/%E8%A3%99%E5%AD%90%E7%B1%BB%E5%9E%8B.jpg)
- 可能会出现腰部摆件，胸前摆件等小摆件
- 布料为保证不出较大的穿模现象，可以接受只有裙子尾部才有动态摆动
![avater](/%E5%B8%83%E6%96%99%E6%A8%A1%E6%8B%9F/%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/%E8%A3%99%E5%AD%90%E5%B0%BE%E9%83%A8%E9%AA%A8%E9%AA%BC.jpg)
- 布料模拟品质要求不高，满足如下表现即可
![avater](/%E5%B8%83%E6%96%99%E6%A8%A1%E6%8B%9F/%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/%E5%B8%83%E6%96%99%E5%93%81%E8%B4%A8.gif)
- 布料需提供可调节参数，例如布料的柔软度、弹性、重力影响等
- 布料模拟效果在游戏运行时具有良好的性能表现，避免过多的计算开销和内存占用
- 可接受部分位置或特别动作穿模
- 布料只考虑单层效果，不做双层布料考虑
- 布料不考虑与场景交互
- 布料不与角色动画相结合
- 布料可暂不考虑风力

### 需求评估
针对布料动态效果要求，以及同屏人数较多的需求，使用动态骨骼方案较为合适。目前通过预研文档，选择了在市面流传较广，优化及使用方案较多的两款插件（Magica Cloth2,Dynamic Bone）进行效果与性能测试
> 布料模拟预研文档 - https://q1doc.yuque.com/wdpcxg/zkwwom/eaeqgy?singleDoc# 

- 效果
    - Dynamic Bone的动态骨骼效果不如Magica Cloth2效果细腻，动态摆动更流畅
    - Magcia Cloth2支持布料模拟
    - 双方都支持动态骨骼到蒙皮动画的过渡切换
- 性能
    - Magica Cloth2目前已经做了性能优化（Job，Brust）
    - Dynamic Bone未做性能优化，须自己做性能优化
    - 在18个角色，每个角色10根骨骼的测试下，Magica Cloth2 约为5ms
    > 性能测试文档 - https://www.yuque.com/qrj999/pnovpg/iy1ipp7au5bx5wx7?singleDoc#
- 结论
可以选择接入Magica Cloth2,在性能上尝试做些提升，针对破晓项目优化隐藏一些不必要属性，因骨骼统一的原因，可以定制一个自动添加碰撞体的操作

